<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Village Defense Game</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="fade-overlay"></div>

<div id="tutorial-text-bubble"></div>

<div id="custom-alert-overlay" style="display: none;">
    <div class="custom-alert-box">
        <h3>Warning!</h3>
        <p>You must place all mandatory blocks before continuing!</p>
        <button id="custom-alert-close-btn" class="menu-btn">OK</button>
    </div>
</div>


<div id="loading-screen">
    <div class="loading-container">
        <h1 class="game-title">Village Defense</h1>
        <div class="cradle">
            <div class="cradle__arm"><div class="cradle__ball"></div></div>
            <div class="cradle__arm"><div class="cradle__ball"></div></div>
            <div class="cradle__arm"><div class="cradle__ball"></div></div>
            <div class="cradle__arm"><div class="cradle__ball"></div></div>
            <div class="cradle__arm"><div class="cradle__ball"></div></div>
        </div>
        <p>Loading...</p>
    </div>
</div>


<div id="main-menu" style="display: none;">
  <h1 class="game-title" id="main-title">Village Defense</h1>
  <div id="animation-stage">
    <img src="HOMEPAGE/land_cartoon.jpg" id="land-img">
    <img src="HOMEPAGE/castle_cartoon.png" id="castle-img">
    <img src="HOMEPAGE/cannon_cartoon.png" id="cannon-img">
    <img src="HOMEPAGE/cannon_ball.png" id="ball-img">
    <img src="HOMEPAGE/kaboom.png" id="kaboom-img">
  </div>
  <div id="difficulty-selection">
    <button class="menu-btn" id="easy-btn">EASY</button>
    <button class="menu-btn" id="hard-btn">HARD</button>
    <button class="menu-btn" id="tutorial-btn">TUTORIAL</button>
  </div>
  <div id="play-container" style="display: none;">
    <button class="menu-btn" id="play-btn">PLAY</button>
  </div>
</div>


<div id="game-stats" style="display: none;">
  <div id="money-container"> Balance: <span id="money-display">1000</span>$ </div>
  <div id="mandatory-container">
    <h4>Mandatory Blocks</h4>
    <div id="mandatory-items">
      <div class="mandatory-item" data-type="house_h2"><canvas class="mini-preview" data-type="house_h2"></canvas><span>Small House</span></div>
      <div class="mandatory-item" data-type="house_h4"><canvas class="mini-preview" data-type="house_h4"></canvas><span>Medium House</span></div>
      <div class="mandatory-item" data-type="house_h6"><canvas class="mini-preview" data-type="house_h6"></canvas><span>Large House</span></div>
    </div>
  </div>
</div>

<div id="sidebar" style="display: none;">
  <h3>Available Objects</h3>
  <div class="palette">
    <div class="item-group">
      <div class="item toggle" data-target="house-submenu">House</div>
        <div class="submenu" id="house-submenu">
          <canvas class="preview" data-type="house_h2" title="Small House"></canvas><div class="item-info">Required: <span id="house_h2-count">0</span></div>
          <canvas class="preview" data-type="house_h4" title="Medium House"></canvas><div class="item-info">Required: <span id="house_h4-count">0</span></div>
          <canvas class="preview" data-type="house_h6" title="Large House"></canvas><div class="item-info">Required: <span id="house_h6-count">0</span></div>
        </div>
    </div>
    <div class="item-group">
      <div class="item toggle" data-target="wall-submenu">Wall</div>
      <div class="submenu" id="wall-submenu">
        <canvas class="preview" data-type="cube"></canvas><div class="item-info">Price: 1$ | Placed: <span id="cube-count">0</span></div>
        <div class="dimension-controls">
           <div class="dim-control"><span>H</span><div class="dim-buttons"><button class="dim-btn" data-type="cube" data-dim="h" data-op="-">-</button><button class="dim-btn" data-type="cube" data-dim="h" data-op="+">+</button></div><span id="cube-h-display">1</span></div>
           <div class="dim-control"><span>W</span><div class="dim-buttons"><button class="dim-btn" data-type="cube" data-dim="w" data-op="-">-</button><button class="dim-btn" data-type="cube" data-dim="w" data-op="+">+</button></div><span id="cube-w-display">1</span></div>
           <div class="dim-control"><span>D</span><div class="dim-buttons"><button class="dim-btn" data-type="cube" data-dim="d" data-op="-">-</button><button class="dim-btn" data-type="cube" data-dim="d" data-op="+">+</button></div><span id="cube-d-display">1</span></div>
        </div>
      </div>
    </div>
    <div class="item-group">
      <div class="item toggle" data-target="strong-submenu">Strong Block</div>
      <div class="submenu" id="strong-submenu">
        <canvas class="preview" data-type="strong"></canvas><div class="item-info">Price: 2$ | Placed: <span id="strong-count">0</span></div>
        <div class="dimension-controls">
           <div class="dim-control"><span>H</span><div class="dim-buttons"><button class="dim-btn" data-type="strong" data-dim="h" data-op="-">-</button><button class="dim-btn" data-type="strong" data-dim="h" data-op="+">+</button></div><span id="strong-h-display">1</span></div>
           <div class="dim-control"><span>W</span><div class="dim-buttons"><button class="dim-btn" data-type="strong" data-dim="w" data-op="-">-</button><button class="dim-btn" data-type="strong" data-dim="w" data-op="+">+</button></div><span id="strong-w-display">1</span></div>
           <div class="dim-control"><span>D</span><div class="dim-buttons"><button class="dim-btn" data-type="strong" data-dim="d" data-op="-">-</button><button class="dim-btn" data-type="strong" data-dim="d" data-op="+">+</button></div><span id="strong-d-display">1</span></div>
        </div>
      </div>
    </div>
  </div>
  <button id="done-button">DONE</button>
</div>


<div id="power-bar-container"><div id="power-bar"></div></div>

<div id="attack-ui" style="display: none;">
  <div id="attack-money-container">Ammo: <span id="attack-money-display">100</span>$</div>
  <div id="ball-selector">
    <div class="ball-option selected" data-ball-type="base"><canvas class="ball-preview" data-type="base"></canvas><span>Base (1$)</span></div>
    <div class="ball-option" data-ball-type="area"><canvas class="ball-preview" data-type="area"></canvas><span>Area (5$)</span></div>
    <div class="ball-option" data-ball-type="punch"><canvas class="ball-preview" data-type="punch"></canvas><span>Punch (10$)</span></div>
  </div>
  <div id="view-controls">
      <button id="toggle-view-btn">First Person</button>
  </div>
</div>


<script id="vs" type="x-shader/x-vertex">
  precision mediump float;
  attribute vec3 position;
  uniform mat4 projectionMatrix;
  uniform mat4 modelViewMatrix;
  uniform float size;
  attribute float adjustSize;
  uniform vec3 cameraPosition;
  varying float distanceCamera;
  attribute vec3 velocity;
  attribute vec4 color;
  varying vec4 vColor;

  void main() {
    vColor = color;
    vec4 modelViewPosition = modelViewMatrix * vec4(position, 1.0);
    gl_PointSize = size * adjustSize * (100.0 / length(modelViewPosition.xyz));
    gl_Position = projectionMatrix * modelViewPosition;
  }
</script>

<script id="fs" type="x-shader/x-fragment">
  precision mediump float;
  uniform sampler2D texture;
  varying vec4 vColor;

  void main() {
    vec4 color = vec4(texture2D(texture, gl_PointCoord));
    gl_FragColor = color * vColor;
  }
</script>

<script type="module" src="main.js"></script>

</body>
</html>